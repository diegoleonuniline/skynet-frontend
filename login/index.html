<!DOCTYPE html>
<html class="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Skynet Login Screen</title>

<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>

<script>
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        primary: "#1E2A3A",
        "background-light": "#f6f7f7",
        "background-dark": "#16191c",
      },
      fontFamily: {
        display: ["Inter"]
      },
      borderRadius: {
        DEFAULT: "0.25rem",
        lg: "0.5rem",
        xl: "0.75rem",
        full: "9999px"
      }
    }
  }
}
</script>

<style type="text/tailwindcss">
body { font-family: 'Inter', sans-serif; }
.material-symbols-outlined {
  font-variation-settings: 'FILL' 0,'wght' 400,'GRAD' 0,'opsz' 24;
}
.checkbox-custom {
  --checkbox-tick-svg: url('data:image/svg+xml,%3csvg viewBox=%270 0 16 16%27 fill=%27rgb(255,255,255)%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3cpath d=%27M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z%27/%3e%3c/svg%3e');
}
</style>
</head>

<body class="bg-background-light dark:bg-background-dark min-h-screen flex flex-col font-display">

<header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-[#dee0e3] dark:border-gray-800 px-10 py-3 bg-white dark:bg-background-dark">
  <div class="flex items-center gap-4 text-primary dark:text-white">
    <div class="size-6">Skynet</div>
    <h2 class="text-lg font-bold leading-tight tracking-[-0.015em]">Skynet</h2>
  </div>
</header>

<main class="flex-1 flex items-center justify-center p-6">

<div class="w-full max-w-[480px] bg-white dark:bg-gray-900 rounded-xl shadow-xl border border-[#dee0e3] dark:border-gray-800 overflow-hidden">

<div class="pt-10 pb-4 text-center">
  <h1 class="text-primary dark:text-white tracking-tight text-2xl font-bold leading-tight px-4">
    Welcome to Skynet
  </h1>
  <p class="text-[#6d757e] dark:text-gray-400 text-sm mt-1 px-4">
    ISP Management Administrative Portal
  </p>
</div>

<form id="formLogin" class="px-8 pb-10 pt-4 flex flex-col gap-5">

<!-- USUARIO -->
<div class="flex flex-col gap-2">
<label class="flex flex-col w-full">
<p class="text-primary dark:text-gray-300 text-sm font-medium leading-normal pb-1">Username</p>
<div class="relative">
<input
  id="usuario"
  class="form-input flex w-full rounded-lg text-primary dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/20 border border-[#dee0e3] dark:border-gray-700 bg-white dark:bg-gray-800 focus:border-primary h-12 placeholder:text-[#6d757e] px-4 pl-10 text-base font-normal leading-normal transition-all"
  placeholder="Enter your username"
/>
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-[#6d757e] text-xl">person</span>
</div>
</label>
</div>

<!-- CONTRASEÑA -->
<div class="flex flex-col gap-2">
<label class="flex flex-col w-full">
<p class="text-primary dark:text-gray-300 text-sm font-medium leading-normal pb-1">Password</p>
<div class="relative">
<input
  id="contrasena"
  type="password"
  class="form-input flex w-full rounded-lg text-primary dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/20 border border-[#dee0e3] dark:border-gray-700 bg-white dark:bg-gray-800 focus:border-primary h-12 placeholder:text-[#6d757e] px-4 pl-10 pr-12 text-base font-normal leading-normal transition-all"
  placeholder="Enter your password"
/>
<span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-[#6d757e] text-xl">lock</span>
</div>
</label>
</div>

<button type="submit" class="flex w-full items-center justify-center rounded-lg h-12 px-4 bg-primary text-white text-base font-bold tracking-[0.015em] hover:bg-primary/90 transition-all">
Log In
</button>

<p id="mensaje" class="hidden text-center text-sm text-red-600"></p>

</form>
</div>
</main>

<!-- LOGIN SCRIPT -->
<script>
const API = "https://skynet-backend-a47423108e2a.herokuapp.com";

document.getElementById("formLogin").addEventListener("submit", async (e) => {
  e.preventDefault();
  const usuario = document.getElementById("usuario").value.trim();
  const contrasena = document.getElementById("contrasena").value;
  const msg = document.getElementById("mensaje");

  msg.classList.add("hidden");

  if (!usuario || !contrasena) {
    msg.textContent = "Ingrese usuario y contraseña";
    msg.classList.remove("hidden");
    return;
  }

  try {
    const r = await fetch(API + "/api/auth/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ usuario, contrasena })
    });
    const d = await r.json();

    if (!d.ok) {
      msg.textContent = d.mensaje;
      msg.classList.remove("hidden");
      return;
    }

    localStorage.setItem("token", d.token);
    localStorage.setItem("usuario", JSON.stringify(d.usuario));
    window.location.href = "/skynet-frontend/dashboard/";
  } catch {
    msg.textContent = "Error de conexión";
    msg.classList.remove("hidden");
  }
});
</script>

</body>
</html>
